{"version":3,"sources":["shared/components/panel/summary/panel-summary.component.ts"],"names":[],"mappings":"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","file":"shared/components/panel/summary/panel-summary.component.js","sourcesContent":["import {\r\n    Component,\r\n    AfterViewInit,\r\n    Input,\r\n    ViewChild,\r\n    ElementRef,\r\n    OnChanges,\r\n    SimpleChanges,\r\n    SimpleChange,\r\n    QueryList\r\n} from '@angular/core';\r\nimport { NgSwitch, NgSwitchCase, NgSwitchDefault } from '@angular/common';\r\nimport { NgSelectOption } from '@angular/forms';\r\n\r\nimport { MATERIAL_DIRECTIVES } from '../../../../shared/libs/angular2-material';\r\n\r\nimport { PanelSummaryImage } from './summary-image/index';\r\nimport { PanelSummaryImages } from './summary-images/index';\r\n\r\n@Component({\r\n    moduleId: module.id,\r\n    selector: 'jpa-panel-summary',\r\n    templateUrl: './panel-summary.component.html',\r\n    styleUrls: ['./panel-summary.component.css'],\r\n    directives: [MATERIAL_DIRECTIVES, PanelSummaryImage, PanelSummaryImages],\r\n    viewProviders: [NgSwitch, NgSwitchCase, NgSwitchDefault]\r\n})\r\nexport class PanelSummaryComponent implements AfterViewInit, OnChanges {\r\n    private imageLoaded = false;\r\n    private _currentImageSize = null;\r\n    private _currentImageName = false;\r\n    private _summary: string = '';\r\n    private _selectOptions: any[];\r\n    private _hasImage = false;\r\n\r\n    private _imagesCount = 0;\r\n    private _imagesQueueCount = 0;\r\n\r\n    @Input() expanded: boolean = false;\r\n    @Input() empty: boolean = true;\r\n    @Input() type: string;\r\n    @Input() value: any;\r\n    @Input() currentImage: any;\r\n    @Input() valueChanged: boolean = false;\r\n    @Input() editText: string;\r\n\r\n    @ViewChild('imagePreview') _imagePreview: ElementRef;\r\n\r\n    set currentImageSize(v: { w: number, h: number }) {\r\n        this._currentImageSize = v;\r\n    }\r\n    get currentImageSize() {\r\n        return this._currentImageSize;\r\n    }\r\n\r\n    ngAfterViewInit() {\r\n        this.summary = this.value;\r\n    }\r\n\r\n    report(e) {\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n        console.log(this);\r\n    }\r\n\r\n    setOptions(options: QueryList<NgSelectOption>) {\r\n        if (options.length) {\r\n        \tthis._selectOptions = options.map(item => {\r\n        \t\treturn {\r\n        \t\t\tvalue: item['_element']['nativeElement']['value'],\r\n        \t\t\tlabel: (<HTMLOptionElement>item['_element']['nativeElement']).innerHTML\r\n        \t\t};\r\n        \t});\r\n\r\n            this.setSummaryOf(this.value);\r\n        }\r\n    }\r\n\r\n    get summary(): any {\r\n        return this._summary;\r\n    }\r\n\r\n    set summary(v: any) {\r\n        console.debug('PanelSummary'+this.type+' setting summary to ', {value: v});\r\n        this._summary = v;\r\n    }\r\n\r\n    ngOnChanges(changes: SimpleChanges) {\r\n        for (let prop in changes) {\r\n            let previousValue = changes[prop].previousValue;\r\n            let currentValue = changes[prop].currentValue;\r\n            let isFirstChange = changes[prop].isFirstChange();\r\n\r\n            console.debug('PanelSummary.'+this.type+'.'+prop + ' changed: ', {from: previousValue, to: currentValue, isFirstChange: isFirstChange});\r\n\r\n            switch (prop) {\r\n                case 'value':\r\n                    this.setSummaryOf(currentValue);\r\n                    this._hasImage = this.type === 'image' && this.currentImage;\r\n                    break;\r\n                case 'empty':\r\n                    this.setSummaryOf(this.value);\r\n                    this._hasImage = this.type === 'image' && this.currentImage;\r\n                    break;\r\n            }\r\n        }\r\n    }\r\n\r\n    setSummaryOf(value: any): void {\r\n        console.log('PanelSummary<'+this.type+'>.setSummaryOf() called with value ', { value: value });\r\n    \tswitch(this.type) {\r\n    \t\tcase 'select':\r\n            console.log('set usmmary of select ', {\r\n                options: this._selectOptions,\r\n                value: value\r\n            });\r\n                if (!this._selectOptions) return;\r\n\r\n                let filtered = this._selectOptions.filter(opt => {\r\n                    return opt['value'] == value;\r\n                });\r\n                if (filtered.length) {\r\n                    this.summary = filtered[0]['label'];\r\n                }\r\n    \t\t\tbreak;\r\n            case 'images':\r\n                if (Array.isArray(this.value)) {\r\n                    let _new = 0;\r\n                    let _old = 0;\r\n\r\n                    this.value.forEach(function(val) {\r\n                        if (val.hasOwnProperty('id')) {\r\n                            _old++;\r\n                        } else {\r\n                            _new++;\r\n                        }\r\n                    });\r\n\r\n                    this._imagesCount = _old;\r\n                    this._imagesQueueCount = _new;\r\n\r\n                    console.debug('set count to ' + this._imagesCount + ' old and ' + this._imagesQueueCount + ' new');\r\n                }\r\n                break;\r\n\t\t\tdefault:\r\n\t\t\t\tthis.summary = value;\r\n\t\t}\r\n    }\r\n}\r\n"],"sourceRoot":"/source/"}