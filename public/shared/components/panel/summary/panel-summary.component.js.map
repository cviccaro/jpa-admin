{"version":3,"sources":["shared/components/panel/summary/panel-summary.component.ts"],"names":[],"mappings":"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","file":"shared/components/panel/summary/panel-summary.component.js","sourcesContent":["import {\n    Component,\n    AfterViewInit,\n    Input,\n    ViewChild,\n    ElementRef,\n    OnChanges,\n    SimpleChanges,\n    SimpleChange,\n    QueryList\n} from '@angular/core';\nimport { NgSwitch, NgSwitchCase, NgSwitchDefault } from '@angular/common';\nimport { NgSelectOption } from '@angular/forms';\n\nimport { MATERIAL_DIRECTIVES } from '../../../../shared/libs/angular2-material';\n\nimport { PanelSummaryImage } from './summary-image/index';\nimport { PanelSummaryImages } from './summary-images/index';\n\n@Component({\n    moduleId: module.id,\n    selector: 'jpa-panel-summary',\n    templateUrl: './panel-summary.component.html',\n    styleUrls: ['./panel-summary.component.css'],\n    directives: [MATERIAL_DIRECTIVES, PanelSummaryImage, PanelSummaryImages],\n    viewProviders: [NgSwitch, NgSwitchCase, NgSwitchDefault]\n})\nexport class PanelSummaryComponent implements AfterViewInit, OnChanges {\n    private imageLoaded = false;\n    private _currentImageSize = null;\n    private _currentImageName = false;\n    private _summary: string = '';\n    private _selectOptions: any[];\n    private _hasImage = false;\n\n    private _imagesCount = 0;\n    private _imagesQueueCount = 0;\n\n    @Input() expanded: boolean = false;\n    @Input() empty: boolean = true;\n    @Input() type: string;\n    @Input() value: any;\n    @Input() currentImage: any;\n    @Input() valueChanged: boolean = false;\n    @Input() editText: string;\n\n    @ViewChild('imagePreview') _imagePreview: ElementRef;\n\n    set currentImageSize(v: { w: number, h: number }) {\n        this._currentImageSize = v;\n    }\n    get currentImageSize() {\n        return this._currentImageSize;\n    }\n\n    ngAfterViewInit() {\n        this.summary = this.value;\n    }\n\n    report(e) {\n        e.preventDefault();\n        e.stopPropagation();\n        console.log(this);\n    }\n\n    setOptions(options: QueryList<NgSelectOption>) {\n        if (options.length) {\n        \tthis._selectOptions = options.map(item => {\n        \t\treturn {\n        \t\t\tvalue: item['_element']['nativeElement']['value'],\n        \t\t\tlabel: (<HTMLOptionElement>item['_element']['nativeElement']).innerHTML\n        \t\t};\n        \t});\n\n            this.setSummaryOf(this.value);\n        }\n    }\n\n    get summary(): any {\n        return this._summary;\n    }\n\n    set summary(v: any) {\n        //console.debug('PanelSummary'+this.type+' setting summary to ', {value: v});\n        this._summary = v;\n    }\n\n    ngOnChanges(changes: SimpleChanges) {\n        for (let prop in changes) {\n            let previousValue = changes[prop].previousValue;\n            let currentValue = changes[prop].currentValue;\n            let isFirstChange = changes[prop].isFirstChange();\n\n            //console.debug('PanelSummary.'+this.type+'.'+prop + ' changed: ', {from: previousValue, to: currentValue, isFirstChange: isFirstChange});\n\n            switch (prop) {\n                case 'value':\n                    this.setSummaryOf(currentValue);\n                    this._hasImage = this.type === 'image' && this.currentImage;\n                    break;\n                case 'empty':\n                    this.setSummaryOf(this.value);\n                    this._hasImage = this.type === 'image' && this.currentImage;\n                    break;\n            }\n        }\n    }\n\n    setSummaryOf(value: any): void {\n        //console.log('PanelSummary<'+this.type+'>.setSummaryOf() called with value ', { value: value });\n    \tswitch(this.type) {\n    \t\tcase 'select':\n                if (!this._selectOptions) return;\n\n                let filtered = this._selectOptions.filter(opt => {\n                    return opt['value'] == value;\n                });\n                if (filtered.length) {\n                    this.summary = filtered[0]['label'];\n                }\n    \t\t\tbreak;\n            case 'images':\n                if (Array.isArray(this.value)) {\n                    let _new = 0;\n                    let _old = 0;\n\n                    this.value.forEach(function(val) {\n                        if (val.hasOwnProperty('id')) {\n                            _old++;\n                        } else {\n                            _new++;\n                        }\n                    });\n\n                    this._imagesCount = _old;\n                    this._imagesQueueCount = _new;\n\n                    //console.debug('set count to ' + this._imagesCount + ' old and ' + this._imagesQueueCount + ' new');\n                }\n                break;\n\t\t\tdefault:\n\t\t\t\tthis.summary = value;\n\t\t}\n    }\n}\n"],"sourceRoot":"/source/"}