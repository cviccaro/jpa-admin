{"version":3,"sources":["shared/models/jp-file.ts"],"names":[],"mappings":"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","file":"shared/models/jp-file.js","sourcesContent":["import { Observable } from 'rxjs/Rx';\n\nexport interface JpFile {\n    alias?: string;\n    alt?: string;\n    created_at?: any;\n    extension?: string;\n    filename?: string;\n    id?: any;\n    idx?: number,\n    isNew?: boolean;\n    last_modified?: any;\n    mimetype?: string;\n    path?: string;\n    size?: number;\n    updated_at?: any;\n    title?: string;\n    url?: string;\n\n    _file?: File;\n    webkitRelativePath?: any;\n\n    date?(): any;\n    load?(imageEl?: HTMLImageElement) : Observable<any>;\n    map?(mapFn: (key: string, val: any) => any): any;\n}\n\nexport class ManagedFile implements JpFile {\n    alias: string;\n    alt: string;\n    created_at: any;\n    extension: string;\n    filename: string;\n    id: any;\n    idx: number;\n    isNew: boolean;\n    last_modified: any;\n    mimetype: string;\n    path: string;\n    size: number;\n    updated_at: any;\n    title: string;\n    url: string;\n\n    _file: File;\n    webkitRelativePath: string;\n\n    constructor(attributes: JpFile, idx: number) {\n        Object.assign(this, attributes);\n\n        this.idx = idx;\n\n        if (attributes._file) {\n            // Fill in managed file from File object\n            let file = attributes._file;\n            this.filename = file.name;\n            this.size = file.size;\n            this.mimetype = file.type;\n            this.extension = file.name.split('.').pop();\n            this.created_at = this.last_modified = file.lastModifiedDate;\n\n            if ( file['webkitRelativePath'] ) {\n                this.webkitRelativePath = file['webkitRelativePath'];\n            }\n        }\n    }\n\n    date() {\n        return this.created_at || this.last_modified;\n    }\n\n    filesize(units: string = 'kb') {\n        let divisor = 10;\n\n        switch(units) {\n            case 'mb':\n                divisor = 100;\n                break;\n        }\n\n        return Math.round(this.size / divisor) / 100;\n    }\n\n    map(mapFn: (key: string, val: any) => any) {\n        let keys = Object.keys(this);\n\n        keys.forEach(key => mapFn.apply(this, [key, this[key]]));\n    }\n}\n\nexport class ManagedImage extends ManagedFile {\n    width: number;\n    height: number;\n\n    constructor(attributes: JpFile, idx: number) {\n        super(attributes, idx);\n    }\n\n    read() : Observable<any> {\n        let file = this._file;\n\n        const filename = file.name;\n\n        return Observable.create(observer => {\n            let reader = new FileReader();\n\n            reader.onload = readerEvt => observer.next(reader.result);\n\n            setTimeout(() => reader.readAsDataURL(file), 50);\n        });\n    }\n\n    load(imageEl: HTMLImageElement) : Observable<any> {\n        return Observable.create(observer => {\n            imageEl.onload = (e) => observer.next({\n                width: imageEl.naturalWidth,\n                height: imageEl.naturalHeight\n            });\n        })\n    }\n\n    watchForDimensions(imageEl: HTMLImageElement) {\n        this.load(imageEl).subscribe(e => {\n            this.width = e.width;\n            this.height = e.height;\n        })\n    }\n\n    megapixels() {\n        return Math.round((this.width * this.height) / 10000) / 100;\n    }\n}\n"],"sourceRoot":"/source/"}