{"version":3,"sources":["@clients/clients.component.ts"],"names":[],"mappings":"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","file":"@clients/clients.component.js","sourcesContent":["import { Component, AfterViewInit } from '@angular/core';\r\nimport { ToasterService } from 'angular2-toaster';\r\nimport { MATERIAL_DIRECTIVES } from '../shared/libs/angular2-material';\r\nimport { JpaCache, JpClient, JpaContextMenu, CONTEXT_MENU_DIRECTIVES, JpaModal, ModalAction, ClientService, TooltipDirective } from '../shared/index';\r\n\r\n@Component({\r\n    moduleId: module.id,\r\n    selector: 'jpa-clients',\r\n    templateUrl: './clients.component.html',\r\n    styleUrls: ['./clients.component.css'],\r\n    directives: [ MATERIAL_DIRECTIVES, CONTEXT_MENU_DIRECTIVES, TooltipDirective ]\r\n})\r\nexport class ClientsComponent implements AfterViewInit {\r\n    public state: any;\r\n    public clients: JpClient[];\r\n\r\n    constructor(\r\n        private service: ClientService,\r\n        private cache: JpaCache,\r\n        private modal: JpaModal,\r\n        private toaster: ToasterService,\r\n        private menu: JpaContextMenu\r\n    ) {\r\n        this.state = this.cache.get('clients');\r\n\r\n        this.state.sortOptions = [\r\n            { name: 'Updated At', value: 'updated_at' },\r\n            { name: 'Created At', value: 'created_at' },\r\n            { name: 'Name', value: 'name' },\r\n            { name: 'Projects', value: 'projects' }\r\n        ];\r\n        this.state.perPageOptions = [5, 10, 15, 25, 50, 100];\r\n        this.state.sort = {\r\n            by: 'name',\r\n            descending: false\r\n        };\r\n        this.clients = this.state.data;\r\n    }\r\n\r\n    ngAfterViewInit() {\r\n        console.log('ClientsComponent View Initialized.', this);\r\n    }\r\n\r\n    add() {\r\n        this.modal.open({\r\n            mode: 'form',\r\n            inputs: [\r\n                { name: 'name', required: true },\r\n                { name: 'alias'},\r\n                { name: 'featured', type: 'checkbox' },\r\n                { name: 'image', type: 'file' }\r\n            ],\r\n            title: 'Add a client'\r\n        }).subscribe((action: ModalAction) => {\r\n            if (action.type === 'submit') {\r\n                let form = action.config.inputs;\r\n\r\n                console.log('We can now save our client with this data: ', {\r\n                    form: form\r\n                });\r\n                this.service.create(form)\r\n                    .subscribe(res => {\r\n                        this.toaster.pop('success', 'Success!', res.name + ' has been created.');\r\n                        setTimeout(() => { this.fetch() },0);\r\n                    })\r\n            }\r\n        });\r\n    }\r\n\r\n    edit(client: JpClient) {\r\n        this.menu.close();\r\n        let modalConfig = {\r\n            mode: 'form',\r\n            inputs: [\r\n                { name: 'name', required: true, value: client.name },\r\n                { name: 'alias', value: client.alias },\r\n                { name: 'featured', type: 'checkbox', value: client.featured },\r\n                { name: 'image_remove', type: 'toggle', label: 'Slide to Delete Image'},\r\n                { name: 'image', type: 'file', label: 'Replace Image', conditions: [\r\n                    {\r\n                        target: 'image_remove',\r\n                        condition: (source, target) => {\r\n                            return target.value;\r\n                        },\r\n                        action: 'hidden'\r\n                    }\r\n                ]},\r\n            ],\r\n            formClass: 'update' + (client.image_id !== null ? ' has-image' : ''),\r\n            okText: 'Save',\r\n            title: 'Edit client ' + client.name\r\n        };\r\n\r\n        if (client.image_id === null) {\r\n            modalConfig.inputs[4]['label'] = 'Add an image';\r\n            modalConfig.inputs.splice(3, 1);\r\n        }\r\n\r\n        this.modal.open(modalConfig).subscribe((action: ModalAction) => {\r\n            if (action.type === 'submit') {\r\n                let form = action.config.inputs;\r\n\r\n                console.log('We can now save our client with this data: ', {\r\n                    form: form\r\n                });\r\n                this.service.update(client.id, form)\r\n                    .subscribe(res => {\r\n                        this.toaster.pop('success', 'Success!', res.name + ' has been edited.');\r\n                        setTimeout(() => { this.fetch() },0);\r\n                    })\r\n            }\r\n        });\r\n    }\r\n\r\n    remove(client: JpClient) {\r\n        this.menu.close();\r\n        let name = client.name;\r\n        this.modal.open({message: 'Discard client?', okText: 'Discard'})\r\n            .subscribe((action: ModalAction) => {\r\n                if (action.type === 'ok') {\r\n                    this.service.destroy(client.id)\r\n                        .subscribe(res => {\r\n                            this.toaster.pop('success', 'Success!', name + ' has been obliterated.');\r\n                            setTimeout(() => { this.fetch() },0);\r\n                        })\r\n                }\r\n            })\r\n    }\r\n\r\n    fetch() {\r\n        this.service.all().subscribe(res => {\r\n            this.clients = res.data;\r\n        });\r\n    }\r\n}\r\n"],"sourceRoot":"/source/"}