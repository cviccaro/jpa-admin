{"version":3,"sources":["@blogs/blog-list.component.ts"],"names":[],"mappings":"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","file":"@blogs/blog-list.component.js","sourcesContent":["import {Component, OnInit, OnDestroy} from '@angular/core';\r\nimport {Router} from '@angular/router';\r\nimport {Subscription} from 'rxjs/Rx';\r\nimport {Blog, BlogService, ListComponent, ListConfig, JpaModal, ModalAction, JpaCache} from '../shared/index';\r\nimport { ToasterService } from 'angular2-toaster';\r\n\r\n/**\r\n * This class represents the lazy loaded BlogsComponent.\r\n */\r\n@Component({\r\n    moduleId: module.id,\r\n    selector: 'jpa-blog-list',\r\n    templateUrl: './blog-list.component.html',\r\n    styleUrls: ['./blog-list.component.css'],\r\n    directives: [\r\n        ListComponent\r\n\t]\r\n})\r\nexport class BlogListComponent implements OnInit, OnDestroy {\r\n\r\n    listData: any[] = [];\r\n    listConfig: ListConfig;\r\n    sub: Subscription;\r\n    modalSub: Subscription;\r\n\r\n\tconstructor(\r\n        public blogService: BlogService,\r\n        private router: Router,\r\n        private modal: JpaModal,\r\n        public toaster: ToasterService,\r\n        private cache: JpaCache\r\n    ) {\r\n        this.listConfig = {\r\n            sortOptions: [\r\n                { name: 'Updated At', value: 'updated_at' },\r\n                { name: 'Created At', value: 'created_at' },\r\n                { name: 'Title', value: 'title' },\r\n                { name: 'Category', value: 'category' }\r\n            ],\r\n            perPageOptions: [5, 10, 15, 25, 50, 100],\r\n            sort: {\r\n                by: 'updated_at',\r\n                descending: true\r\n            },\r\n            page: {\r\n                currentPage: 1,\r\n                from: 0,\r\n                to: 0,\r\n                total: 0,\r\n                lastPage: 0,\r\n                perPage: 15\r\n            }\r\n        };\r\n\t}\r\n\r\n\tngOnInit() {\r\n        this.parseList(this.cache.get('blogList'));\r\n\t}\r\n\r\n    mapList(blog: any) {\r\n        return {\r\n            id: blog.id,\r\n            title: blog.title,\r\n            subtitle: blog.tags.length ? blog.tags[0].name : '',\r\n            dates: {\r\n                updated_at: blog.updated_at,\r\n                created_at: blog.created_at\r\n            }\r\n        };\r\n    }\r\n\r\n    parseList(json: any) {\r\n        this.listData = json.data.map(this.mapList);\r\n\r\n        this.listConfig.page = {\r\n            from: json.from,\r\n            to: json.to,\r\n            total: json.total,\r\n            lastPage: json.last_page,\r\n            currentPage: json.current_page,\r\n            perPage: json.per_page\r\n        };\r\n    }\r\n\r\n    fetch(params: { page?: any, sort?: any } = {}) {\r\n        let page = params.page || this.listConfig.page;\r\n        let sort = params.sort || this.listConfig.sort;\r\n\r\n        this.sub = this.blogService.all({\r\n            current_page: page.currentPage,\r\n            length: page.perPage,\r\n            order_by: sort.by,\r\n            descending: sort.descending,\r\n        })\r\n        .subscribe(json => this.parseList(json));\r\n    }\r\n\r\n    add() {\r\n        this.router.navigate(['/blogs', 'new']);\r\n    }\r\n\r\n    edit(blog: Blog) {\r\n        this.router.navigate(['/blogs', blog.id]);\r\n    }\r\n\r\n    destroy(blog: Blog) {\r\n        console.log('delete this item: ', blog);\r\n        if (this.modalSub) {\r\n            this.modalSub.unsubscribe();\r\n        }\r\n\r\n        let title = blog.title;\r\n\r\n        this.modalSub = this.modal.open({message: 'Discard blog?', okText: 'Discard'})\r\n            .subscribe((action:ModalAction) => {\r\n               if (action.type === 'ok') {\r\n                   console.log('lets kill this blog!', blog);\r\n                   this.blogService.destroy(blog.id)\r\n                       .subscribe(res => {\r\n                           this.toaster.pop('success', 'Success!', title + ' has been obliterated.');\r\n                           setTimeout(() => { this.fetch() },0);\r\n                       })\r\n               }\r\n\r\n               return;\r\n            });\r\n    }\r\n\r\n    onPageChange(num: number) {\r\n        this.listConfig.page.currentPage = num;\r\n        this.fetch();\r\n    }\r\n\r\n    ngOnDestroy() {\r\n        if (this.sub) this.sub.unsubscribe();\r\n        if (this.modalSub) this.modalSub.unsubscribe();\r\n    }\r\n}\r\n"],"sourceRoot":"/source/"}