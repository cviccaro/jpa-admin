{"version":3,"sources":["@blogs/blog.component.ts"],"names":[],"mappings":"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","file":"@blogs/blog.component.js","sourcesContent":["import {\n    AfterViewInit,\n    AfterViewChecked,\n    AfterContentChecked,\n    AfterContentInit,\n    Component,\n    HostBinding,\n    OnInit,\n    QueryList,\n    ViewChild,\n    ViewChildren,\n    ContentChildren\n} from '@angular/core';\nimport { ActivatedRoute, Router } from '@angular/router';\nimport { Observable } from 'rxjs/Rx';\nimport { NgForm, FormControl, FormControlDirective } from '@angular/forms';\nimport { MATERIAL_DIRECTIVES } from '../shared/libs/angular2-material';\nimport { ToasterService } from 'angular2-toaster';\n\nimport {\n    ImageUpload,\n    JpaMdSelectComponent,\n    JpaPanel,\n    JpaPanelGroup,\n    JpaPanelContent,\n    JpImage,\n    BlogService,\n    Blog,\n    DivisionService,\n    Tag,\n    TagService\n} from '../shared/index';\n\n@Component({\n    moduleId: module.id,\n    templateUrl: './blog.component.html',\n    styleUrls: ['./blog.component.css'],\n    directives: [\n        MATERIAL_DIRECTIVES,\n        JpaMdSelectComponent,\n        JpaPanel,\n        JpaPanelGroup,\n        JpaPanelContent,\n        NgForm\n    ]\n})\nexport class BlogComponent implements OnInit, AfterViewInit {\n    public divisions: string[];\n    public tags: string[];\n\n    public ready: boolean = false;\n    public submitted = false;\n\n    private _originalTitle: string;\n    private _isNew: boolean = false;\n    private _blog: Blog = new Blog();\n    private _blogImage: JpImage = undefined;\n\n    get blog(): Blog { return this._blog; }\n    set blog(v: Blog) {\n        this._blog = v;\n        this.setup();\n    }\n\n    constructor(\n        private route: ActivatedRoute,\n        private service: BlogService,\n        private divisionService: DivisionService,\n        private toasterService: ToasterService,\n        private tagService: TagService,\n        private router: Router\n    ) { }\n\n    ngOnInit() {\n        this.tags = this.tagService.cached();\n        this.divisions = this.divisionService.cached();\n\n        let id = this.route.snapshot.params['id'];\n\n        if (id === 'new') {\n            this.ready = true;\n            this._isNew = true;\n        } else {\n            this.service.find(+id).subscribe(res => {\n                this.blog = res;\n                console.debug('setting blog model to ', res);\n                this.ready = true;\n            });\n        }\n\n        console.info('BlogComponent#'+(this._isNew?'create':'edit')+' initialized.', this);\n    }\n\n    ngAfterViewInit() {\n        console.info('BlogComponent#'+(this._isNew?'create':'edit')+' View Initialized.', this);\n    }\n\n    onSubmit() {\n        this.submitted = true;\n        if (this._isNew) {\n            console.log('Save NEW blog. ', this.blog);\n            this.service.create(this.blog)\n                .subscribe(res => {\n                    this.toasterService.pop('success', 'Success!', this.blog.title + ' has been created.  Redirecting to its page.');\n                    setTimeout(() => {\n                        this.blog = res;\n                        console.log(\"Navigating to /blogs/\" + res.id);\n                        this.router.navigate(['/blogs', res.id]);\n                        this.reset();\n                    }, 2000);\n                },err => {\n                    console.log('Error when saving blog: ', err);\n                    this.toasterService.pop('error', 'Uh oh.', 'Something went wrong when saving this blog.  Sorry.  Try again later and/or alert the developer!');\n                });\n        } else {\n            console.log('Save UPDATED blog. ', this.blog);\n            this.service.update(this.blog.id, this.blog)\n                .subscribe(res => {\n                    console.log('response from update: ', res);\n                    this.blog = res;\n                    this.reset();\n                    this.toasterService.pop('success', 'Success!', this.blog.title + ' has been saved.');\n                }, err => {\n                    console.log('Error when saving blog: ', err);\n                    this.toasterService.pop('error', 'Uh oh.', 'Something went wrong when saving this blog.  Sorry.  Try again later and/or alert the developer!');\n                });\n        }\n    }\n\n    private setup() {\n        this._blogImage = this._blog.image;\n        this._blog.image = null;\n        this._originalTitle = this._blog.title;\n        this._isNew = this.blog.id === undefined;\n        console.info('BlogComponent.setup()', this);\n    }\n\n    private reset(e?:Event) {\n        if (e) {\n            e.preventDefault();\n            e.stopPropagation();\n        }\n        console.info('BlogComponent.reset()', this);\n\n        // this._panelChildren.forEach(panel => {\n        //     panel.reset();\n        // });\n\n        // Temporary workaround until angular2 implements\n        // a proper form reset\n        this.ready = false;\n\n        setTimeout(() => { this.ready = true; },0);\n    }\n\n    report(e) {\n        e.preventDefault();\n        e.stopPropagation();\n\n        console.log(this.blog);\n    }\n}\n"],"sourceRoot":"/source/"}