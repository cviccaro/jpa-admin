{"version":3,"sources":["@projects/project.component.ts"],"names":[],"mappings":"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","file":"@projects/project.component.js","sourcesContent":["import { Component, HostBinding, OnInit } from '@angular/core';\nimport { ActivatedRoute, Router } from '@angular/router';\nimport { FormControl } from '@angular/forms';\nimport { Observable } from 'rxjs/Rx';\nimport { ToasterService } from 'angular2-toaster';\n\nimport { MATERIAL_DIRECTIVES } from '../shared/libs/angular2-material';\nimport {\n    ProjectService,\n    Project,\n    JpaCache,\n    PANEL2_DIRECTIVES,\n    PanelFormControl,\n    PanelFormControlTextfield,\n    PanelFormControlSelect,\n    PanelFormControlTextarea,\n    PanelFormControlDragnDrop,\n    PanelFormControlFiles\n} from '../shared/index';\n\n@Component({\n    moduleId: module.id,\n    templateUrl: './project.component.html',\n    styleUrls: ['./project.component.css'],\n    directives: [\n        MATERIAL_DIRECTIVES,\n        PANEL2_DIRECTIVES\n    ]\n})\nexport class ProjectComponent implements OnInit {\n    public clients: { label: string, value: any }[];\n    public isNew: boolean = false;\n    public ready: boolean = false;\n    public saving: boolean = false;\n\n    private _originalTitle: string;\n    private _project: Project = new Project();\n\n    public controls: PanelFormControl<any>[];\n\n    @HostBinding('class.new') get isNewClass() { return this.isNew; }\n\n    constructor(\n        private route: ActivatedRoute,\n        private service: ProjectService,\n        private toasterService: ToasterService,\n        private router: Router,\n        private cache: JpaCache\n    ) { }\n\n    get project(): Project { return this._project; }\n    set project(v: Project) {\n        this._project = v;\n        this.setup();\n    }\n\n    ngOnInit() {\n        this.clients = this.cache.get('clients');\n\n        if (this.route.snapshot.params['id'] === 'new') {\n            this.ready = true;\n            this.isNew = true;\n        } else {\n            // this.project = this.cache.get('project');\n            // this.ready = true;\n\n            this.service.find(+this.route.snapshot.params['id']).subscribe(res => {\n                this.project = res;\n                console.debug('setting project model to ', res);\n                this.ready = true;\n            });\n        }\n\n        this.controls = [\n          new PanelFormControlTextfield({\n            name: 'title',\n            required: true,\n            order: 3\n          }),\n          new PanelFormControlSelect({\n              name: 'client_id',\n              label: 'Client',\n              required: true,\n              options: this.clients\n          }),\n          new PanelFormControlTextarea({\n              name: 'description',\n              required: true,\n              ckeditor: true\n          }),\n          new PanelFormControlFiles({\n              name: 'image',\n              label: 'Cover Image',\n              required: true,\n              multiple: false,\n              type: 'image'\n          }),\n          new PanelFormControlFiles({\n              name: 'images',\n              required: false,\n              multiple: true,\n              filesLabel: 'images in gallery',\n              type: 'image'\n          })\n        ];\n\n        console.info('ProjectComponent#'+(this.isNew?'create':'edit')+' initialized.', this);\n    }\n\n    onSubmit(model) {\n        this.saving = true;\n\n        if (this.isNew) {\n            console.log('Save NEW project. ', model);\n            this.service.create(model)\n                .subscribe(res => {\n                    this.toasterService.pop('success', 'Success!', res.title + ' has been created.  Redirecting to its page.');\n                    setTimeout(() => {\n                        this.project = res;\n                        this.saving = false;\n                        console.log(\"Navigating to /projects/\" + res.id);\n                        this.router.navigate(['/projects', res.id]);\n                        this.reset();\n                    }, 2000);\n                },err => {\n                    console.log('Error when saving project: ', err);\n                    this.saving = false;\n                    this.toasterService.pop('error', 'Uh oh.', 'Something went wrong when saving this project.  Sorry.  Try again later and/or alert the developer!');\n                });\n        } else {\n            console.log('Save UPDATED project. ', model);\n            this.service.update(this.project.id, model)\n                .subscribe(res => {\n                    console.log('response from update: ', res);\n                    this.project = res;\n                    this.saving = false;\n                    this.reset();\n                    this.toasterService.pop('success', 'Success!', res.title + ' has been saved.');\n                }, err => {\n                    console.log('Error when saving projet: ', err);\n                    this.saving = false;\n                    this.toasterService.pop('error', 'Uh oh.', 'Something went wrong when saving this project.  Sorry.  Try again later and/or alert the developer!');\n                });\n        }\n    }\n\n    private setup() {\n        this._originalTitle = this._project.title;\n        this.isNew = this.project.id === undefined;\n        console.info('ProjectComponent.setup()', this);\n    }\n\n    private reset(e?:Event) {\n        if (e) {\n            e.preventDefault();\n            e.stopPropagation();\n        }\n        console.info('ProjectComponent.reset()', this);\n\n        // Temporary workaround until angular2 implements\n        // a proper form reset\n        this.ready = false;\n\n        setTimeout(() => { this.ready = true; },0);\n    }\n}\n"],"sourceRoot":"/source/"}