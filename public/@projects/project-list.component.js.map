{"version":3,"sources":["@projects/project-list.component.ts"],"names":[],"mappings":"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","file":"@projects/project-list.component.js","sourcesContent":["import {Component, OnInit, OnDestroy} from '@angular/core';\nimport {Router} from '@angular/router';\nimport {Subscription} from 'rxjs/Rx';\nimport {Project, ProjectService, ListComponent, ListConfig, JpaModal, ModalAction, JpaCache} from '../shared/index';\nimport { ToasterService } from 'angular2-toaster';\n\n/**\n * This class represents the lazy loaded ProjectListComponent.\n */\n@Component({\n    moduleId: module.id,\n    selector: 'jpa-project-list',\n    templateUrl: './project-list.component.html',\n    styleUrls: ['./project-list.component.css'],\n    directives: [\n        ListComponent\n\t]\n})\nexport class ProjectListComponent implements OnInit {\n\n    listData: any[] = [];\n    listConfig: ListConfig;\n    sub: Subscription;\n    modalSub: Subscription;\n\n    constructor(\n        public projectService: ProjectService,\n        private router: Router,\n        private modal: JpaModal,\n        public toaster: ToasterService,\n        private cache: JpaCache\n    ) {\n        this.listConfig = {\n            sortOptions: [\n                { name: 'Updated At', value: 'updated_at' },\n                { name: 'Created At', value: 'created_at' },\n                { name: 'Title', value: 'title' },\n                { name: 'Category', value: 'category' }\n            ],\n            perPageOptions: [5, 10, 15, 25, 50, 100],\n            sort: {\n                by: 'updated_at',\n                descending: true\n            },\n            page: {\n                currentPage: 1,\n                from: 0,\n                to: 0,\n                total: 0,\n                lastPage: 0,\n                perPage: 15\n            },\n            emptyText: 'Looks like no projects have been created yet.'\n        };\n\t}\n\n\tngOnInit() {\n        this.parseList(this.cache.get('projectList'));\n\t}\n\n    parseList(json) {\n        this.listData = json.data.map(this.mapList);\n        this.listConfig.page = {\n            from: json.from,\n            to: json.to,\n            total: json.total,\n            lastPage: json.last_page,\n            currentPage: json.current_page,\n            perPage: json.per_page\n        };\n    }\n\n    fetch(params: { page?: any, sort?: any } = {}) {\n        let page = params.page || this.listConfig.page;\n        let sort = params.sort || this.listConfig.sort;\n\n        this.projectService.all({\n            current_page: page.currentPage,\n            length: page.perPage,\n            order_by: sort.by,\n            descending: sort.descending,\n        })\n        .subscribe(json => this.parseList(json));\n    }\n\n    mapList(project: any) {\n        return {\n            id: project.id,\n            title: project.title,\n            subtitle: project.client.name,\n            dates: {\n                updated_at: project.updated_at,\n                created_at: project.created_at\n            }\n        };\n    }\n\n    add() {\n        this.router.navigate(['/projects', 'new']);\n    }\n\n    edit(project: Project) {\n        this.router.navigate(['/projects', project.id]);\n    }\n\n    destroy(project: Project) {\n        console.log('delete this item: ', project);\n        if (this.modalSub) {\n            this.modalSub.unsubscribe();\n        }\n\n        let title = project.title;\n\n        this.modalSub = this.modal.open({message: 'Discard project?', okText: 'Discard'})\n            .subscribe((action:ModalAction) => {\n               if (action.type === 'ok') {\n                   console.log('lets kill this project!', project);\n                   this.projectService.destroy(project.id)\n                       .subscribe(res => {\n                           this.toaster.pop('success', 'Success!', title + ' has been obliterated.');\n                           setTimeout(() => { this.fetch() },0);\n                       })\n               }\n\n               return;\n            });\n    }\n\n    onPageChange(num: number) {\n        this.listConfig.page.currentPage = num;\n        this.fetch();\n    }\n\n    ngOnDestroy() {\n        if (this.sub) this.sub.unsubscribe();\n        if (this.modalSub) this.modalSub.unsubscribe();\n    }\n}\n"],"sourceRoot":"/source/"}